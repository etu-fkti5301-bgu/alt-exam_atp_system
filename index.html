<!DOCTYPE html>

<head>
  <meta charset="utf-8">
  <link rel="stylesheet" type="text/css" href="css/style.css">
  <title>Automated theorem proving system</title>

  <script type="text/javascript">
    const errorMessage = 'undefined',
          stateComplete = 4,
          statusOK = 200;

    function checkAlgorithm() {
      if (document.getElementById('alg').value == 'unf') {
        document.getElementById('sndInput').hidden = false;
      } else {
        document.getElementById('sndInput').hidden = true;
        document.getElementById('sndInput').value = '';
      }
    }

    function sendRequest() {
      var message = 'alg=' + encodeURIComponent(document.getElementById('alg').value) +
                    '&fstInput=' + encodeURIComponent(document.getElementById('fstInput').value) +
                    '&sndInput=' + encodeURIComponent(document.getElementById('sndInput').value);

      var request = new XMLHttpRequest();
      request.open('POST', '/', true);
      request.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
      request.onreadystatechange = function() {
        if (request.readyState == stateComplete) {
          if (request.status == statusOK) {
            var response, innerHTML,
                serverResponse = decodeURIComponent(request.responseText).replace(/\\n/g, " | ")
                                                                         .replace(/\\/g, "&#");

            if (serverResponse != 'undefined') {
              response = JSON.parse(serverResponse);
              innerHTML =
                '<p>' +
                '<b>Formula: </b>' + response.parsed[0] + '</br>' +
                '<b>Result: </b>'+ response.result[0] + '</br>' +
                '</p>';
            } else {
              innerHTML = '<p>' + errorMessage + '</p>';
            }

            document.getElementById('output-content').innerHTML = innerHTML;
            document.getElementById('output').style.visibility = 'visible';
          }
        }
      }

      request.send(message);
    }
  </script>
</head>

<body>

    <div class="header">
      <h1 class="header-title">
        Automated theorem proving system
      </h1>
    </div> <!-- end header -->

    <div class="main">
      <div id="form">
        <input id="fstInput" class="input-field" type="text" placeholder="none" size="64"/>
        <select id="alg" onchange="checkAlgorithm()">
          <option value="pnf">PNF</option>
          <option value="snf">SNF</option>
          <option value="rsl">Resolution</option>
          <option value="unf">Unification</option>
        </select>
        <button onclick="sendRequest()">Submit</button></br>

        <input id="sndInput" class="input-field" type="text" placeholder="none" size="64" hidden="true"/>
      </div>

      <div id="output"> <!-- this div should be made visible after receiving results -->
        <div id="output-content"></div> <!-- put results here -->
      </div>

    </div> <!-- end main -->

    <div class="footer">
    </div> <!-- end footer -->

</body>
